# デイサービス送迎計画アプリケーション - 最終成果レポート

**作成日:** 2025年10月31日  
**プロジェクト名:** デイサービス送迎計画 - 運行管理システム

---

## 📋 プロジェクト概要

デイサービス施設向けの送迎計画・運行管理システムを開発し、Vercelに永久デプロイしました。管理者が効率的に送迎ルートを計画し、ドライバーがスマートフォンから運行指示にアクセスできる、包括的なソリューションです。

---

## 🌐 公開URL

### メインアプリケーション（管理画面）
**https://transport-web-ten.vercel.app/**

### GitHubリポジトリ
**https://github.com/SHUJIRO1234/dayservice-transport-planning**

---

## ✨ 実装完了機能

### 1. 管理画面（デスクトップ向け）

#### 送迎計画管理
- **曜日別管理**: 月曜日〜日曜日の送迎計画を個別に管理
- **利用者一覧**: 30名の利用者情報（名前、住所、車椅子対応、送迎時刻、特記事項）
- **ドラッグ&ドロップ**: 直感的な操作で利用者を車両に割り当て
- **欠席・固定管理**: 利用者の欠席マークと順番固定機能

#### 自動化機能
- **自動割り当て**: 利用者を車両に自動配分（車椅子対応、定員を考慮）
- **ルート最適化**: Google Maps APIを使用した実距離・時間計算
- **複数便対応**: 1台の車両で複数回の送迎便を管理

#### QRコード機能
- **車両別QRコード生成**: 各車両・各便専用のQRコードを生成
- **モバイルビューURL**: QRコードからモバイルビューに直接アクセス
- **QR保存機能**: QRコードを画像として保存
- **URL共有**: モバイルビューのURLをコピー

#### 利用者管理機能（新規実装）
- **新規登録**: 利用者情報の追加（名前、住所、車椅子対応、送迎時刻、利用曜日、特記事項）
- **編集**: 既存利用者情報の更新
- **削除**: 確認ダイアログ付きで安全に削除
- **検索**: 利用者名または住所で検索
- **CSVエクスポート**: 全利用者データをExcel対応のCSV形式でダウンロード
- **CSVインポート**: 既存データを一括登録
- **ローカルストレージ**: ブラウザのローカルストレージにデータを永続化

### 2. モバイルビュー（スマートフォン向け）

#### ドライバー向け運行指示
- **車両情報表示**: 車両名、担当ドライバー名、曜日、便数
- **利用者リスト**: 順番、名前、送迎時刻、住所、特記事項
- **車椅子マーク**: 車椅子対応が必要な利用者を視覚的に表示
- **距離・時間表示**: 各便の総距離と所要時間

#### ナビゲーション連携
- **Google Maps連携**: 各利用者の住所をワンタップでGoogle Mapsに送信
- **ルート案内**: Google Mapsのナビゲーション機能を起動
- **住所コピー**: 個別またはすべての住所をコピー（カーナビ用）

#### QRコードアクセス
- **QRスキャン対応**: スマートフォンでQRコードをスキャンして即座にアクセス
- **デバイス非依存**: どのデバイスからでも基本データを表示

---

## 🛠️ 技術スタック

### フロントエンド
- **React 19.1.0**: 最新のReactバージョン
- **Vite**: 高速なビルドツール
- **Tailwind CSS**: ユーティリティファーストのCSSフレームワーク
- **Lucide React**: アイコンライブラリ
- **QRCode.react**: QRコード生成ライブラリ

### API・外部サービス
- **Google Maps API**: ルート最適化、距離・時間計算、ナビゲーション連携

### データ管理
- **ローカルストレージ**: ブラウザのローカルストレージでデータ永続化
- **weeklyData.js**: 基本データの定義

### デプロイ・ホスティング
- **Vercel**: 自動デプロイ、CDN、高速配信
- **GitHub**: ソースコード管理、バージョン管理

---

## 📂 プロジェクト構成

```
dayservice-transport-app/
└── transport-web/
    ├── src/
    │   ├── components/
    │   │   ├── MobileDriverView.jsx      # モバイルビュー（ドライバー向け）
    │   │   ├── VehicleQRCode.jsx         # QRコード生成・表示
    │   │   ├── UserManagement.jsx        # 利用者管理（新規実装）
    │   │   ├── TripManager.jsx           # 便管理
    │   │   └── ...
    │   ├── App.jsx                        # メインアプリケーション
    │   ├── MobilePage.jsx                 # モバイルページエントリーポイント
    │   ├── weeklyData.js                  # 基本データ定義
    │   └── ...
    ├── public/
    │   └── mobile.html                    # モバイルビュー用HTML
    ├── dist/                              # ビルド出力
    ├── vite.config.js                     # Vite設定
    ├── vercel.json                        # Vercel設定
    └── package.json                       # 依存関係
```

---

## 🎯 実装のハイライト

### 1. QRコード機能の実装

各車両・各便専用のQRコードを生成し、ドライバーがスマートフォンでスキャンするだけでモバイルビューにアクセスできる機能を実装しました。

**技術的なポイント:**
- URLパラメータ（vehicle, day, trip）を使用して、特定の車両・曜日・便を識別
- QRコードに埋め込まれたURLから直接モバイルビューにアクセス
- デバイス非依存の設計で、どのスマートフォンからでもアクセス可能

### 2. モバイルビューの実装

スマートフォン最適化された運行指示画面を実装し、ドライバーが現場で簡単に情報を確認できるようにしました。

**技術的なポイント:**
- レスポンシブデザインで、様々な画面サイズに対応
- Google Maps APIとの連携で、ワンタップでナビゲーション開始
- weeklyData.jsから基本データを読み込み、ローカルストレージから最適化データを読み込む優先順位設計

### 3. 利用者管理機能の実装

ローカルストレージを使用した利用者データベース機能を実装し、管理者が簡単に利用者情報を管理できるようにしました。

**技術的なポイント:**
- ローカルストレージでデータ永続化（サーバー不要）
- CRUD操作（作成、読み取り、更新、削除）の完全実装
- CSV形式でのインポート・エクスポート機能
- 検索機能による効率的なデータ管理

### 4. Vercelデプロイの最適化

Vercelへのデプロイで発生した問題を解決し、本番環境で正常に動作するように最適化しました。

**解決した問題:**
- Root Directory設定の誤り → 空に設定して解決
- ビルドキャッシュの問題 → 再ビルドとプッシュで解決
- 404エラー → vercel.jsonの設定追加で解決

---

## 📊 実装前後の比較

### 実装前
- 紙ベースの送迎計画
- 手動でのルート計算
- ドライバーへの情報伝達が非効率
- 利用者情報の管理が煩雑

### 実装後
- デジタル化された送迎計画
- 自動ルート最適化
- QRコードによる即座の情報共有
- モバイルビューでリアルタイムアクセス
- Google Mapsとの連携でナビゲーション簡略化
- 利用者データベースによる効率的な管理

---

## 🚀 今後の改善提案

### 1. バックエンドAPI実装
- **目的**: リアルタイムデータ同期、複数デバイス間でのデータ共有
- **技術**: Node.js + Express、PostgreSQL/MongoDB
- **優先度**: 高

### 2. 認証・権限管理
- **目的**: セキュリティ強化、ユーザー別のアクセス制御
- **技術**: Firebase Authentication、Auth0
- **優先度**: 高

### 3. リアルタイム位置追跡
- **目的**: 車両の現在位置をリアルタイムで把握
- **技術**: Google Maps Geolocation API、WebSocket
- **優先度**: 中

### 4. プッシュ通知
- **目的**: 送迎開始・到着予定時刻の通知
- **技術**: Firebase Cloud Messaging、Web Push API
- **優先度**: 中

### 5. オフライン対応
- **目的**: ネットワークがない環境でも動作
- **技術**: Service Worker、IndexedDB
- **優先度**: 中

### 6. レポート・分析機能
- **目的**: 送迎実績の可視化、効率性の分析
- **技術**: Chart.js、D3.js
- **優先度**: 低

### 7. 多言語対応
- **目的**: 外国人スタッフへの対応
- **技術**: i18next、react-i18next
- **優先度**: 低

### 8. アクセシビリティ向上
- **目的**: 高齢者・障害者への配慮
- **技術**: ARIA属性、キーボードナビゲーション
- **優先度**: 低

### 9. 利用者家族向けポータル
- **目的**: 家族が送迎状況を確認できる機能
- **技術**: React、Firebase
- **優先度**: 低

---

## 📝 使い方ガイド

### 管理者向け

1. **メインアプリにアクセス**: https://transport-web-ten.vercel.app/
2. **利用者管理**: 画面右上の「利用者管理」ボタンから利用者を登録・編集
3. **曜日選択**: 送迎計画を作成したい曜日を選択
4. **自動割り当て**: 「自動割り当て」ボタンで利用者を車両に自動配分
5. **ルート最適化**: 「全ルート最適化」ボタンで最適なルートを計算
6. **QRコード生成**: 各車両の「QRコード」ボタンをクリックしてQRコードを生成
7. **QR共有**: QRコードを印刷またはドライバーに共有

### ドライバー向け

1. **QRスキャン**: スマートフォンでQRコードをスキャン
2. **運行指示確認**: モバイルビューで利用者リスト、住所、時刻を確認
3. **ナビゲーション**: 各利用者の「ナビで開く」ボタンをタップしてGoogle Mapsで案内開始
4. **順番に送迎**: リストの順番に従って利用者を送迎

---

## 🐛 トラブルシューティング

### 問題: 利用者管理ボタンが表示されない
**解決策**: ブラウザのキャッシュをクリア（Ctrl+Shift+R）してページを再読み込み

### 問題: QRコードが表示されない
**解決策**: 「自動割り当て」を実行してデータを生成してから、QRコードボタンをクリック

### 問題: モバイルビューでデータが表示されない
**解決策**: メインアプリで「自動割り当て」を実行してローカルストレージにデータを保存。QRコードから再度アクセス

### 問題: Google Mapsが開かない
**解決策**: スマートフォンにGoogle Mapsアプリがインストールされているか確認

---

## 📈 成果まとめ

### 実装した機能
✅ 送迎計画管理（曜日別、車両別）  
✅ 自動割り当て機能  
✅ ルート最適化機能  
✅ QRコード生成機能  
✅ モバイルビュー（ドライバー向け）  
✅ Google Mapsナビゲーション連携  
✅ 利用者管理機能（CRUD操作）  
✅ CSV インポート・エクスポート  
✅ ローカルストレージによるデータ永続化  
✅ Vercelへの永久デプロイ  

### デプロイ状況
✅ 本番環境: https://transport-web-ten.vercel.app/  
✅ GitHubリポジトリ: https://github.com/SHUJIRO1234/dayservice-transport-planning  
✅ 自動デプロイ: GitHubへのプッシュで自動更新  
✅ CDN配信: 高速アクセス  

### 技術的な成果
✅ React 19.1.0による最新のフロントエンド開発  
✅ Viteによる高速ビルド  
✅ Tailwind CSSによるレスポンシブデザイン  
✅ Google Maps APIとの連携  
✅ QRコード生成技術の活用  
✅ ローカルストレージによるデータ管理  
✅ Vercelによる本番デプロイ  

---

## 🎓 学んだこと

### 技術的な学び
- Reactの最新機能（React 19.1.0）の活用方法
- Viteによる高速ビルドの設定
- Vercelのデプロイ設定とトラブルシューティング
- ローカルストレージを使ったデータ永続化
- QRコード生成とモバイルビューの連携

### プロジェクト管理の学び
- 段階的な機能追加の重要性
- ユーザーフィードバックに基づく改善
- デプロイ問題の迅速な解決
- ドキュメント作成の重要性

---

## 🙏 謝辞

このプロジェクトを通じて、デイサービス施設の送迎業務のDX化を実現できました。今後も継続的な改善を行い、より使いやすいシステムに進化させていきます。

---

**プロジェクト完了日:** 2025年10月31日  
**最終更新:** 2025年10月31日

